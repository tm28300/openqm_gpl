<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if(top.frames.length==0) { top.location.href="index.html?qmclient.htm"; }
else { parent.quicksync('a8'); }
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>QMClient API</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="QMClient" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">QMClient API</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="_.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="cgi.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmclientsecurity.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Historically, multi-value databases have used a character based user interface. QM includes a set of Windows OLE compatible functions that enable development of applications in, for example, Visual Basic. This section describes these functions and includes examples of how to use them to develop a Windows style front end to your application.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The same functions are also available in the qmclilib library for use in C programs and as a QMBasic class module for use in QMBasic programs. This help section discusses all of these API sets.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">In addition, the QMClient.pb record in the SYSCOM file contains an interface layer for use with the PureBasic product from Fantaisie Software.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Overview</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The API functions enable a Visual Basic or C application to access data stored in a QM database or allow connection to remote QM systems from within QMBasic application programs. There are API equivalents to the major file handling statements of QMBasic as well as a range of string functions for dynamic array data manipulations, functions to execute commands and catalogued subroutines on the server, etc.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The secret of writing efficient client server applications is to perform the bulk data processing on the server and only handle user interface issues on the client. This minimises the data transferred between the systems and hence optimises performance.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">QMClient has some <a href="qmclientsecurity.htm">security issues</a> that need special consideration.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Using the Visual Basic API</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="color: #000000;">QMClient</span><span style="color: #000000;"> Windows API consists of two components; a Visual Basic module (QMClient.bas) containing the API function definitions, and a dynamic link library (QMClient.dll) containing the actual interface functions. The C programmers' API is a single library, qmclilib.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">To use the API functions in a Visual Basic application, include the QMClient.bas module in your project. This module is placed in the SYSCOM file of the QMSYS account when QM is installed. The QMClient.dll library must be installed on the client system. This library is placed in the Windows directory (not necessarily c:\windows) when QM is installed. These components may be freely copied and distributed as necessary.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">From QM release 2.2-8, QMClient allows up to four connections from a single client process. This allows development of applications that transfer data between accounts or servers.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Functions that return boolean values, return 0 for False, -1 for True in the Visual Basic API.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Using the C API</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Use of the C programmers' API is different depending on the compiler in use. On Linux and FreeBSD, programs need to include the qmclilib.o object file when linking the application. The Linux version of QM also includes a shared object version of QMClient API named qmclilib.so. On Windows, the qmclilib.dll dynamic link library is used and two import libraries are provided to include when linking the application; qmcllbbl.lib for Borland C users and qmcllbms.lib for Microsoft C users. All of these components can be found in the bin subdirectory of the QMSYS account. The function definitions can be found in the qmclilib.h include record in the SYSCOM file.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">QMClient allows up to four connections from a single client process. This allows development of applications that transfer data between accounts or servers.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Functions that return boolean values, return 0 for False, 1 for True in the C API library.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">API calls that return strings dynamically allocate memory to hold the returned data. It is the calling program's responsibility to release this memory using the </span><span style="font-weight: bold; color: #000000;"><a href="qmfree.htm">QMFree()</a></span><span style="color: #000000;"> function when it is no longer required. This function must be used in place of the standard </span><span style="font-weight: bold; color: #000000;">free()</span><span style="color: #000000;"> C runtime library routine to ensure compatibility with the memory allocator used by the QMClient library.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Using the QMBasic Class Module API</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The QMClient class module is supplied as a globally catalogued item named !QMCLIENT. To create a QMClient session, the object is instantiated with a statement of the form</span></p>
<p style="margin: 10px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">session = object(&quot;!qmclient&quot;)</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The session is then connected to a server using the CONNECT method</span></p>
<p style="margin: 10px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">ok = session-&gt;connect(</span><span style="font-family: 'Courier New'; font-style: italic; color: #000000;">hostname</span><span style="font-family: 'Courier New'; color: #000000;">, </span><span style="font-family: 'Courier New'; font-style: italic; color: #000000;">port</span><span style="font-family: 'Courier New'; color: #000000;">, </span><span style="font-family: 'Courier New'; font-style: italic; color: #000000;">user</span><span style="font-family: 'Courier New'; color: #000000;">, </span><span style="font-family: 'Courier New'; font-style: italic; color: #000000;">password</span><span style="font-family: 'Courier New'; color: #000000;">, </span><span style="font-family: 'Courier New'; font-style: italic; color: #000000;">account</span><span style="font-family: 'Courier New'; color: #000000;">)</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The four connection limit that applies to other QMClient API styles does not apply to the QMBasic interface. The limit here is imposed by how many socket connections the underlying system permits.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Functions that return boolean values, return 0 for False, 1 for True in the QMBasic class module API.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">API Function Summary</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Session Management</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmconnect.htm">QMConnect()</a></span></td><td><span style="color: #000000;">Establishes a QMClient session via a network</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmconnected.htm">QMConnected()</a></span></td><td><span style="color: #000000;">Verifies whether a QMClient session is open</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmconnectlocal.htm">QMConnectLocal()</a></span></td><td><span style="color: #000000;">Establishes a QMClient session on the local system</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmdisconnect.htm">QMDisconnect</a></span></td><td><span style="color: #000000;">Terminates a QMClient session</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmdisconnect.htm">QMDisconnectAll</a></span></td><td><span style="color: #000000;">Terminates all QMClient sessions from this client</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmgetsession.htm">QMGetSession</a></span></td><td><span style="color: #000000;">Retrieves currently select session number</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmlogto.htm">QMLogto()</a></span></td><td><span style="color: #000000;">Moves to an alternative account</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmsetsession.htm">QMSetSession</a></span></td><td><span style="color: #000000;">Selects the session to which subsequent function calls relate</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">File Handling</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmclearselect.htm">QMClearSelect</a></span></td><td><span style="color: #000000;">Clears a select list</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmclose.htm">QMClose</a></span></td><td><span style="color: #000000;">Closes a file</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmdelete.htm">QMDelete</a></span></td><td><span style="color: #000000;">Deletes a record</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmdeleteu.htm">QMDeleteu</a></span></td><td><span style="color: #000000;">Deletes a record, retaining the lock</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmmarkmapping.htm">QMMarkMapping()</a></span></td><td><span style="color: #000000;">Enables/disables mark mapping for a directory file</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmopen.htm">QMOpen()</a></span></td><td><span style="color: #000000;">Opens a file</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmread.htm">QMRead()</a></span></td><td><span style="color: #000000;">Reads a record without locking</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmreadl.htm">QMReadl()</a></span></td><td><span style="color: #000000;">Reads a record with a shareable read lock</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmreadlist.htm">QMReadList()</a></span></td><td><span style="color: #000000;">Reads a select list</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmreadnext.htm">QMReadNext()</a></span></td><td><span style="color: #000000;">Retrieves a record id from a select list</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmreadu.htm">QMReadu()</a></span></td><td><span style="color: #000000;">Reads a record with an exclusive update lock</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmrecordlock.htm">QMRecordlock()</a></span></td><td><span style="color: #000000;">Locks a record</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmrelease.htm">QMRelease</a></span></td><td><span style="color: #000000;">Releases a record lock</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmselect.htm">QMSelect()</a></span></td><td><span style="color: #000000;">Generates a select list</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmselectindex.htm">QMSelectIndex()</a></span></td><td><span style="color: #000000;">Generates a select list from an alternate key index</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmselectleft.htm">QMSelectLeft()</a></span></td><td><span style="color: #000000;">Scan left in an alternate key index</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmselectleft.htm">QMSelectRight()</a></span></td><td><span style="color: #000000;">Scan right in an alternate key index</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmsetleft.htm">QMSetLeft()</a></span></td><td><span style="color: #000000;">Position at the left in an alternate key index</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmsetleft.htm">QMSetRight()</a></span></td><td><span style="color: #000000;">Position at the right in an alternate key index</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmwrite.htm">QMWrite</a></span></td><td><span style="color: #000000;">Writes a record</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmwriteu.htm">QMWriteu</a></span></td><td><span style="color: #000000;">Writes a record, retaining the lock</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">Dynamic Array Manipulation</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmdel.htm">QMDel()</a></span></td><td><span style="color: #000000;">Deletes a field, value or subvalue</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmextract.htm">QMExtract()</a></span></td><td><span style="color: #000000;">Extracts a field, value or subvalue</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmins.htm">QMIns()</a></span></td><td><span style="color: #000000;">Inserts a field, value or subvalue</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmlocate.htm">QMLocate()</a></span></td><td><span style="color: #000000;">Searches for a field, value or subvalue</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmreplace.htm">QMReplace()</a></span></td><td><span style="color: #000000;">Replaces a field, value or subvalue</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">String Manipulation</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmchange.htm">QMChange()</a></span></td><td><span style="color: #000000;">Change substrings </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmdcount.htm">QMDcount()</a></span></td><td><span style="color: #000000;">Count delimited items in a string</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmfield.htm">QMField()</a></span></td><td><span style="color: #000000;">Extract substring from a delimited string</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmfree.htm">QMFree()</a></span></td><td><span style="color: #000000;">Free dynamically allocated memory (C API only)</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmmatch.htm">QMMatch()</a></span></td><td><span style="color: #000000;">Test pattern match</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmmatchfield.htm">QMMatchfield()</a></span></td><td><span style="color: #000000;">Extract data based on pattern match</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">Command Execution</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmendcommand.htm">QMEndCommand</a></span></td><td><span style="color: #000000;">Abort an executed command</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmexecute.htm">QMExecute()</a></span></td><td><span style="color: #000000;">Execute a command on the server</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmrespond.htm">QMRespond()</a></span></td><td><span style="color: #000000;">Respond to a request for input from an executed command</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">Subroutine Execution</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmcall.htm">QMCall</a></span></td><td><span style="color: #000000;">Call a catalogued subroutine on the server</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="font-weight: bold; color: #000000;">Error Handling</span></p>
<p style="text-indent: -180px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmerror.htm">QMError()</a></span></td><td><span style="color: #000000;">Returns extended error message text</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="font-weight: bold; color: #000000;"><a href="qmstatus.htm">QMStatus()</a></span></td><td><span style="color: #000000;">Returns STATUS() value</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Many functions have an </span><span style="font-style: italic; color: #000000;">Errno</span><span style="color: #000000;"> argument passed by reference as an Integer variable. This will be set to one of the following values broadly corresponding to the various clauses applicable to the equivalent </span><span style="color: #000000;">QMBasic</span><span style="color: #000000;"> statements.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="color: #000000;">0</span></td><td><span style="color: #000000;">SV_OK &nbsp; &nbsp; &nbsp; &nbsp;Action successful</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 210px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="color: #000000;">1</span></td><td><span style="color: #000000;">SV_ON_ERROR &nbsp; &nbsp; &nbsp; &nbsp;Action took the ON ERROR clause to recover from a situation that would otherwise cause the server process to abort.</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 210px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="color: #000000;">2</span></td><td><span style="color: #000000;">SV_ELSE &nbsp; &nbsp; &nbsp; &nbsp;Action took the ELSE clause. In most cases the </span><span style="font-weight: bold; color: #000000;"><a href="qmstatus.htm">QMStatus()</a></span><span style="color: #000000;"> function can be used to determine the error number.</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 210px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="color: #000000;">3</span></td><td><span style="color: #000000;">SV_ERROR &nbsp; &nbsp; &nbsp; &nbsp;An error occurred for which extended error text can be retrieved using the </span><span style="font-weight: bold; color: #000000;"><a href="qmerror.htm">QMError()</a></span><span style="color: #000000;"> function.</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 210px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="color: #000000;">4</span></td><td><span style="color: #000000;">SV_LOCKED &nbsp; &nbsp; &nbsp; &nbsp;The action was blocked by a lock held by another user. The </span><span style="font-weight: bold; color: #000000;"><a href="qmstatus.htm">QMStatus()</a></span><span style="color: #000000;"> function can be used to determine the blocking user.</span></td></tr></table></div><p style="text-indent: -180px; margin: 0px 0px 0px 210px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="180"><span style="color: #000000;">5</span></td><td><span style="color: #000000;">SV_PROMPT &nbsp; &nbsp; &nbsp; &nbsp;A command executed on the server is waiting for input. The only valid client functions when this status is returned are </span><span style="font-weight: bold; color: #000000;"><a href="qmrespond.htm">QMRespond()</a></span><span style="color: #000000;">, </span><span style="font-weight: bold; color: #000000;"><a href="qmendcommand.htm">QMEndCommand</a></span><span style="color: #000000;">and </span><span style="font-weight: bold; color: #000000;"><a href="qmdisconnect.htm">QMDisconnect</a></span><span style="color: #000000;">.</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The tokens shown above are defined in the QMClient.bas module and the qmclilib.h C include file.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>

</td></tr></table>

</body>
</html>
