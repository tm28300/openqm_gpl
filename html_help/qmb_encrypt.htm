<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if(top.frames.length==0) { top.location.href="index.html?qmb_encrypt.htm"; }
else { parent.quicksync('a7.5.76'); }
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>ENCRYPT()</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">ENCRYPT()</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="_.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_echo.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_end.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">ENCRYPT()</span><span style="color: #000000;"> function encrypts data for secure storage or transmission.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Format</span></p>
<p><span style="font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-weight: bold; color: #000000;">ENCRYPT(</span><span style="font-style: italic; color: #000000;">data</span><span style="font-weight: bold; color: #000000;">,</span><span style="font-style: italic; color: #000000;"> key</span><span style="font-weight: bold; color: #000000;">)</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">where</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">data</span></td><td><span style="color: #000000;">is the string to be encrypted</span><span style="color: #000000;">.</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">key</span></td><td><span style="color: #000000;">is the encryption key to be used</span><span style="color: #000000;">.</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">ENCRYPT</span><span style="font-weight: bold; color: #000000;">()</span><span style="color: #000000;"> function applies the AES 128 bit encryption algorithm to the supplied data and returns the encrypted text. The key string may be up to 64 characters in length and may contain any character. It is automatically transformed into a form that is useable by the AES algorithm. For optimum data security, the key should be about 16 characters.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The encrypted data is post-processed so that it can never contain characters from the C0 control group (characters 0 to 31) or the mark characters. As a result of this operation, the encrypted data is slightly longer than the original source data. </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Example</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;">FUNCTION LOGIN()</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; OPEN 'USERS' TO USR.F ELSE</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp;&nbsp;&nbsp;&nbsp; DISPLAY 'Cannot open USERS file'</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp;&nbsp;&nbsp;&nbsp; RETURN @FALSE</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; END</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; DISPLAY 'User name: ' :</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; INPUT USERNAME, 20_:</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; READ USER.REC FROM USR.F THEN</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp;&nbsp;&nbsp;&nbsp; FOR I = 1 TO 3</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DISPLAY 'Password: ' :</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INPUT PW,20_: HIDDEN</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IF ENCRYPT(PW, 'MySecretKey') = USR.REC&lt;1&gt; THEN RETURN @TRUE</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DISPLAY 'Password incorrect'</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp;&nbsp;&nbsp;&nbsp; NEXT I</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; END</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; RETURN @FALSE</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;">END</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The above function prompts for a user name and password, validating these against a record in the USERS file. The password field of this file is encrypted.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">See also:</span></p>
<p><span style="color: #000000;"><a href="encryption.htm">Data encryption</a>, </span><span style="font-weight: bold; color: #000000;"><a href="qmb_decrypt.htm">DECRYPT()</a></span></p>

</td></tr></table>

</body>
</html>
