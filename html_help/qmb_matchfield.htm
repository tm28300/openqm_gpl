<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if(top.frames.length==0) { top.location.href="index.html?qmb_matchfield.htm"; }
else { parent.quicksync('a7.5.149'); }
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>MATCHFIELD</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="MATCHFIELD" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">MATCHFIELD</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="_.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_matbuild.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_matparse.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">MATCHFIELD()</span><span style="color: #000000;"> function extracts a portion of a string that matches a pattern element.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Format</span></p>
<p><span style="font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-weight: bold; color: #000000;">MATCHFIELD</span><span style="color: #000000;">(</span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;">, </span><span style="font-style: italic; color: #000000;">pattern</span><span style="color: #000000;">, </span><span style="font-style: italic; color: #000000;">element</span><span style="color: #000000;">)</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">where</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">string</span></td><td><span style="color: #000000;">evaluates to the string in which the <a href="patterns.htm">pattern</a> is to be located.</span></td></tr></table></div><p style="text-indent: -90px; margin: 0px 0px 0px 120px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">pattern</span></td><td><span style="color: #000000;">evaluates to a template as described below.</span></td></tr></table></div><p style="text-indent: -90px; margin: 0px 0px 0px 120px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">element</span></td><td><span style="color: #000000;">evaluates to an integer indicating which pattern element of </span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;"> is to be returned.</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">MATCHFIELD()</span><span style="color: #000000;"> function matches </span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;"> against </span><span style="font-style: italic; color: #000000;">pattern</span><span style="color: #000000;"> and returns the portion of </span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;"> that matches the </span><span style="font-style: italic; color: #000000;">element</span><span style="color: #000000;">'th component of </span><span style="font-style: italic; color: #000000;">pattern</span><span style="color: #000000;">.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-style: italic; color: #000000;">pattern</span><span style="color: #000000;"> string consists of one or more concatenated items from the following list.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="color: #000000;">...</span></td><td><span style="color: #000000;">Zero or more characters of any type</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="color: #000000;">0X</span></td><td><span style="color: #000000;">Zero or more characters of any type</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">X</span></td><td><span style="color: #000000;">Exactly </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;"> characters of any type</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">-</span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;">X</span></td><td><span style="color: #000000;">Between </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;"> and </span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;"> characters of any type</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="color: #000000;">0A</span></td><td><span style="color: #000000;">Zero or more alphabetic characters</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">A</span></td><td><span style="color: #000000;">Exactly </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;"> alphabetic characters</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">-</span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;">A</span></td><td><span style="color: #000000;">Between </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;"> and </span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;"> alphabetic characters</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="color: #000000;">0N</span></td><td><span style="color: #000000;">Zero or more numeric characters</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">N</span></td><td><span style="color: #000000;">Exactly </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;"> numeric characters</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 10px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">-</span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;">N</span></td><td><span style="color: #000000;">Between </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;"> and </span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;"> numeric characters</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="90"><span style="color: #000000;">&quot;</span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;">&quot;</span></td><td><span style="color: #000000;">A literal string which must match exactly. Either single or double quotation marks may be used. Unlike the </span><span style="font-weight: bold; color: #000000;">MATCHES</span><span style="color: #000000;"> operator, </span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;"> must be enclosed in quotes otherwise each character is treated as a separate component.</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The values </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;"> and </span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;"> are integers with any number of digits. </span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;"> must be greater than or equal to </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The 0A, </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">A, 0N, </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">N and &quot;</span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;">&quot; patterns may be preceded by a tilde (~) to invert the match condition. For example, ~4N matches four non-numeric characters such as ABCD (not a string which is not four numeric characters such as 12C4).</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">A null string matches patterns ..., 0A, 0X, 0N, their inverses (~0A, etc) and &quot;&quot;.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The 0X and </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">-</span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;">X patterns match against as few characters as necessary before control passes to the next pattern. For example, the string ABC123DEF matched against the pattern 0X2N0X matches the pattern components as ABC, 12 and 3DEF.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The 0N, </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">-</span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;">N, 0A, and </span><span style="font-style: italic; color: #000000;">n</span><span style="color: #000000;">-</span><span style="font-style: italic; color: #000000;">m</span><span style="color: #000000;">A patterns match against as many characters as possible. For example, the string ABC123DEF matched against the pattern 0X2-3N0X matches the pattern components as ABC, 123 and DEF.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-style: italic; color: #000000;">pattern</span><span style="color: #000000;"> string may contain alternative templates separated by value marks. The </span><span style="font-weight: bold; color: #000000;">MATCHFIELD()</span><span style="color: #000000;"> function tries each template in turn until one is a successful match against </span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;">.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-style: italic; color: #000000;">element</span><span style="color: #000000;"> argument determines which component of </span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;"> is returned as the </span><span style="font-weight: bold; color: #000000;">MATCHFIELD()</span><span style="color: #000000;"> function result. For example,</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">MATCHFIELD(&quot;ABC123DEF&quot;, &quot;0X2N0X&quot;, 2)</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">returns the string &quot;12&quot;.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">MATCHFIELD()</span><span style="color: #000000;"> function returns a null string if no component of </span><span style="font-style: italic; color: #000000;">pattern</span><span style="color: #000000;"> matches </span><span style="font-style: italic; color: #000000;">string</span><span style="color: #000000;">.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Example</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">TEL.NO = &quot;01604-709200&quot;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">LOCAL.NO = MATCHFIELD(TEL.NO, &quot;0N'-'0N&quot;, 3)</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">This program fragment extracts the local part of a telephone number (709200 in this case). Note that the literal element counts as a component of the string when identifying each element.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">If the delimiter is multiple characters but not quoted, each character is counted as a separate element:</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="452"><span style="font-family: 'Courier New'; color: #000000;">MATCHFIELD(&quot;123--456&quot;, &quot;0N'--'0N&quot;, 1)</span></td><td><span style="font-family: 'Courier New'; color: #000000;">returns&nbsp; 123 </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="452"><span style="font-family: 'Courier New'; color: #000000;">MATCHFIELD(&quot;123--456&quot;, &quot;0N'--'0N&quot;, 2)</span></td><td><span style="font-family: 'Courier New'; color: #000000;">returns&nbsp; -- </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="452"><span style="font-family: 'Courier New'; color: #000000;">MATCHFIELD(&quot;123--456&quot;, &quot;0N'--'0N&quot;, 3)</span></td><td><span style="font-family: 'Courier New'; color: #000000;">returns&nbsp; 456</span></td></tr></table></div><p style="text-indent: -452px; margin: 0px 0px 0px 482px;"><span style="font-family: 'Courier New'; color: #000000;"> </span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="452"><span style="font-family: 'Courier New'; color: #000000;">MATCHFIELD(&quot;123--456&quot;, &quot;0N--0N&quot;, 1)</span></td><td><span style="font-family: 'Courier New'; color: #000000;">returns&nbsp; 123 </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="452"><span style="font-family: 'Courier New'; color: #000000;">MATCHFIELD(&quot;123--456&quot;, &quot;0N--0N&quot;, 2)</span></td><td><span style="font-family: 'Courier New'; color: #000000;">returns&nbsp; - </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="452"><span style="font-family: 'Courier New'; color: #000000;">MATCHFIELD(&quot;123--456&quot;, &quot;0N--0N&quot;, 3)</span></td><td><span style="font-family: 'Courier New'; color: #000000;">returns&nbsp; - </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="452"><span style="font-family: 'Courier New'; color: #000000;">MATCHFIELD(&quot;123--456&quot;, &quot;0N--0N&quot;, 4)</span></td><td><span style="font-family: 'Courier New'; color: #000000;">returns&nbsp; 456</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">See also:</span></p>
<p><span style="color: #000000;"><a href="patterns.htm">Pattern Matching</a></span></p>

</td></tr></table>

</body>
</html>
