<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if(top.frames.length==0) { top.location.href="index.html?qmb_connect_port.htm"; }
else { parent.quicksync('a7.5.46'); }
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>CONNECT.PORT()</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">CONNECT.PORT()</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="_.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_config.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_continue.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">CONNECT.PORT</span><span style="font-weight: bold; color: #000000;">()</span><span style="color: #000000;"> function converts a phantom process into an interactive session, using a serial port as its terminal device.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">This function is only available on Windows.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Format</span></p>
<p><span style="font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-weight: bold; color: #000000;">CONNECT.PORT(</span><span style="font-style: italic; color: #000000;">port</span><span style="font-weight: bold; color: #000000;">, </span><span style="font-style: italic; color: #000000;">baud</span><span style="font-weight: bold; color: #000000;">,</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">parity</span><span style="font-weight: bold; color: #000000;">,</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">bits</span><span style="font-weight: bold; color: #000000;">,</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">stop</span><span style="font-weight: bold; color: #000000;">)</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">where</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="89"><span style="font-style: italic; color: #000000;">port</span></td><td><span style="color: #000000;">is the name of the serial port to be used (e.g. COM1)</span><span style="color: #000000;">.</span></td></tr></table></div><p style="text-indent: -89px; margin: 0px 0px 0px 119px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="89"><span style="font-style: italic; color: #000000;">baud</span></td><td><span style="color: #000000;">evaluates to the data rate (e.g. 9600).</span></td></tr></table></div><p style="text-indent: -89px; margin: 0px 0px 0px 119px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="89"><span style="font-style: italic; color: #000000;">parity</span></td><td><span style="color: #000000;">specifies the parity setting for the connection (0 = none, 1 = odd, 2 = even).</span></td></tr></table></div><p style="text-indent: -89px; margin: 0px 0px 0px 119px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="89"><span style="font-style: italic; color: #000000;">bits</span></td><td><span style="color: #000000;">specifies the number of bits per byte.</span></td></tr></table></div><p style="text-indent: -89px; margin: 0px 0px 0px 119px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="89"><span style="font-style: italic; color: #000000;">stop</span></td><td><span style="color: #000000;">specifies the number of stop bits (1 or 2).</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">CONNECT.PORT()</span><span style="color: #000000;"> function enables an application to start a phantom process that then uses a serial port as though it were a terminal device. The function returns true (1) if successful, false (0) if it fails. The </span><span style="font-weight: bold; color: #000000;"><a href="qmb_status.htm">STATUS()</a></span><span style="color: #000000;"> function can be used to determine the cause of failure.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Once the connection has been created, the process changes from a phantom to an interactive session and can use the normal QMBasic terminal i/o statements such as </span><span style="font-weight: bold; color: #000000;"><a href="qmb_input.htm">INPUT</a></span><span style="color: #000000;"> and </span><span style="font-weight: bold; color: #000000;"><a href="qmb_print.htm">PRINT</a></span><span style="color: #000000;"> to access the port. If the program exits to the command processor, the connection can be used in exactly the same way as if the user had logged in over the serial port. To terminate the session from within a program, execute the </span><span style="font-weight: bold; color: #000000;"><a href="quit.htm">QUIT</a></span><span style="color: #000000;"> command.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Because this function converts the phantom process into an interactive user, the process consumes a licence. The </span><span style="font-weight: bold; color: #000000;">CONNECT.PORT()</span><span style="color: #000000;"> function will fail if the user limit has been reached.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Example</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;">IF NOT(CONNECT.PORT('COM1', 9600, 0, 8, 1)) THEN</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; STOP 'Cannot open COMO1 port'</span></p>
<p><span style="font-family: 'Courier New'; color: #000000;">END</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">This program fragment, used in a phantom process, connects to the device on the COM1 port as the command source, converting the process into an interactive session.</span></p>

</td></tr></table>

</body>
</html>
