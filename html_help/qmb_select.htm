<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if(top.frames.length==0) { top.location.href="index.html?qmb_select.htm"; }
else { parent.quicksync('a7.5.229'); }
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>SELECT</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="SELECT,SELECTN,SELECTV" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">SELECT, SELECTN, SELECTV</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="_.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_seek.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_selecte.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">SELECT</span><span style="color: #000000;"> statement creates a select list containing all record keys from a file.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Format</span></p>
<p><span style="font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-weight: bold; color: #000000;">SELECT</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">var</span><span style="color: #000000;"> {</span><span style="font-weight: bold; color: #000000;">TO</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">list.no</span><span style="color: #000000;">} {</span><span style="font-weight: bold; color: #000000;">ON ERROR</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">statement(s)</span><span style="color: #000000;">}</span></p>
<p style="margin: 10px 0px 0px 30px;"><span style="font-weight: bold; color: #000000;">SELECTN</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">var</span><span style="color: #000000;"> {</span><span style="font-weight: bold; color: #000000;">TO</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">list.no</span><span style="color: #000000;">} {</span><span style="font-weight: bold; color: #000000;">ON ERROR</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">statement(s)</span><span style="color: #000000;">}</span></p>
<p style="margin: 10px 0px 0px 30px;"><span style="font-weight: bold; color: #000000;">SELECTV</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">var</span><span style="color: #000000;"> </span><span style="font-weight: bold; color: #000000;">TO</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">list.var</span><span style="color: #000000;"> {</span><span style="font-weight: bold; color: #000000;">ON ERROR</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">statement(s)</span><span style="color: #000000;">}</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">where</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="150"><span style="font-style: italic; color: #000000;">var</span></td><td><span style="color: #000000;">is the file variable associated with an open file or a field mark delimited dynamic array of items to form the list.</span></td></tr></table></div><p style="text-indent: -150px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="150"><span style="font-style: italic; color: #000000;">list.no</span></td><td><span style="color: #000000;">is the select list number of the list to be created. If omitted, select list zero is used.</span></td></tr></table></div><p style="text-indent: -150px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="150"><span style="font-style: italic; color: #000000;">list.var</span></td><td><span style="color: #000000;">is the select list variable to receive the list. Select list variables can be processed by the </span><span style="font-weight: bold; color: #000000;"><a href="qmb_readnext.htm">READNEXT</a></span><span style="color: #000000;"> statement as an alternative to using numbered select lists.</span></td></tr></table></div><p style="text-indent: -150px; margin: 0px 0px 0px 180px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="150"><span style="font-style: italic; color: #000000;">statement(s)</span></td><td><span style="color: #000000;">are statement(s) to be executed if a fatal error occurs.</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">SELECT</span><span style="color: #000000;"> and </span><span style="font-weight: bold; color: #000000;">SELECTN</span><span style="color: #000000;"> statements construct a list of record keys in the file open as </span><span style="font-style: italic; color: #000000;">var</span><span style="color: #000000;"> and store this as an active select list </span><span style="font-style: italic; color: #000000;">list.no</span><span style="color: #000000;"> replacing any previously active list. If there are no records in the file, an empty list is created.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">|The </span><span style="font-weight: bold; color: #000000;">SELECTV</span><span style="color: #000000;"> statement constructs the list in the same way but stores it in a select list variable which can be processed by a subsequent use of </span><span style="font-weight: bold; color: #000000;"><a href="qmb_readnext.htm">READNEXT</a></span><span style="color: #000000;">. </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">For compatibility with other database products, the action of the </span><span style="font-weight: bold; color: #000000;">SELECT</span><span style="color: #000000;"> statement can be changed to produce a select list variable in the same was as </span><span style="font-weight: bold; color: #000000;">SELECTV</span><span style="color: #000000;">. This is achieved by setting the </span><span style="font-weight: bold; color: #000000;">SELECTV</span><span style="color: #000000;"> option of the </span><span style="font-weight: bold; color: #000000;"><a href="qmbd_mode.htm">$MODE</a></span><span style="color: #000000;"> compiler directive.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="color: #000000;">QMBasic</span><span style="color: #000000;"> </span><span style="font-weight: bold; color: #000000;">SELECT</span><span style="color: #000000;"> statement uses an optimised method for processing hashed files such that each group is examined only when the record keys are extracted from the select list. This reduces disk transfers and gives better application performance than constructing the entire list in one operation. This benefit does not apply to </span><span style="font-weight: bold; color: #000000;">SELECTV</span><span style="color: #000000;">. This overlapping of processing with record selection means that, if the application writes new records while the select list is being processed, these new records may be seen later in the operation.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">It is important that a program that does not completely process a select list should use </span><span style="font-weight: bold; color: #000000;"><a href="qmb_clearselect.htm">CLEARSELECT</a></span><span style="color: #000000;"> to clear the remainder of the list. While the list is active, split and merge operations are suspended on the data file. Thus, leaving a list active may cause the file performance to degrade if updates are made. Note that the file will automatically reconfigure for optimum performance once the select operation has terminated.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;"><a href="at_variables.htm#selected">@SELECTED</a> </span><span style="color: #000000;">variable is set to the number of records selected for a directory file or the number of records in the first non-empty group for a dynamic file.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The optional </span><span style="font-weight: bold; color: #000000;">ON ERROR</span><span style="color: #000000;"> clause is executed in the event of a fatal error. This covers such situations as disk hardware errors and faults in the internal structure of the file. The </span><span style="font-weight: bold; color: #000000;"><a href="qmb_status.htm">STATUS()</a></span><span style="color: #000000;"> function will return a value relating to the cause of the error. If no </span><span style="font-weight: bold; color: #000000;">ON ERROR</span><span style="color: #000000;"> clause is present, a fatal error will result in an abort.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Except where the </span><span style="font-weight: bold; color: #000000;">ON ERROR</span><span style="color: #000000;"> clause is taken, the </span><span style="font-weight: bold; color: #000000;"><a href="qmb_status.htm">STATUS()</a></span><span style="color: #000000;"> function will return zero.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Use of a Dynamic Array instead of a File Variable</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">For compatibility with Pick style environments, QM also supports a variation on these statements where the </span><span style="font-style: italic; color: #000000;">var</span><span style="color: #000000;"> is a dynamic array in which each field becomes an entry in the target select list.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Example</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">SELECT STAFF TO 7</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">This statement creates a list of the records on the file with file variable STAFF and saves it as active select list 7.</span></p>

</td></tr></table>

</body>
</html>
