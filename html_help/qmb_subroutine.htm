<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- saved from url=(0029)http://www.helpandmanual.com/ -->
<head><script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if(top.frames.length==0) { top.location.href="index.html?qmb_subroutine.htm"; }
else { parent.quicksync('a7.5.260'); }
//-->
</script>
<script type="text/javascript" src="highlight.js"></script>
   <title>SUBROUTINE</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="SUBROUTINE" />
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;" onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div>


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <p class="p_Heading1"><span class="f_Heading1">SUBROUTINE</span></p>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="_.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_subr.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_substitute.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;"> statement introduces a subroutine. The abbreviation </span><span style="font-weight: bold; color: #000000;">SUB</span><span style="color: #000000;"> may be used.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold; color: #000000;">Format</span></p>
<p><span style="font-weight: bold; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">name</span><span style="color: #000000;">{</span><span style="font-weight: bold; color: #000000;">(</span><span style="font-style: italic; color: #000000;">arg1</span><span style="color: #000000;"> {</span><span style="font-weight: bold; color: #000000;">,</span><span style="color: #000000;"> </span><span style="font-style: italic; color: #000000;">arg2</span><span style="color: #000000;">...}</span><span style="font-weight: bold; color: #000000;">)</span><span style="color: #000000;"> {</span><span style="font-weight: bold; color: #000000;">VAR.ARGS</span><span style="color: #000000;">}}</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">where</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="120"><span style="font-style: italic; color: #000000;">name</span></td><td><span style="color: #000000;">is the name of the subroutine.</span></td></tr></table></div><p style="text-indent: -120px; margin: 0px 0px 0px 150px;"><span style="color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 30px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="120"><span style="font-style: italic; color: #000000;">arg1</span><span style="color: #000000;">, etc</span></td><td><span style="color: #000000;">are the names of the arguments to the subroutine.</span></td></tr></table></div><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">QMBasic</span><span style="color: #000000;"> programs should commence with a </span><span style="font-weight: bold; color: #000000;"><a href="qmb_program.htm">PROGRAM</a></span><span style="color: #000000;">, </span><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;">, </span><span style="font-weight: bold; color: #000000;"><a href="qmb_function.htm">FUNCTION</a></span><span style="color: #000000;"> or </span><span style="font-weight: bold; color: #000000;"><a href="qmb_class.htm">CLASS</a></span><span style="color: #000000;"> statement. If none of these is present</span><span style="font-weight: bold; color: #000000;">,</span><span style="color: #000000;"> the compiler behaves as though a </span><span style="font-weight: bold; color: #000000;"><a href="qmb_program.htm">PROGRAM</a></span><span style="color: #000000;"> statement had been used with </span><span style="font-style: italic; color: #000000;">name</span><span style="color: #000000;"> as the name of the source record.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The </span><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;"> statement must appear before any executable statements. A </span><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;"> with no arguments is equivalent to a </span><span style="font-weight: bold; color: #000000;"><a href="qmb_program.htm">PROGRAM</a></span><span style="color: #000000;">. The brackets are optional if there are no arguments. The </span><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;"> statement may be split over multiple lines by breaking after a comma.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The name used in a </span><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;"> statement need not be related to the name of the source record though this eases program maintenance. The name must comply with the </span><span style="color: #000000;">QMBasic</span><span style="color: #000000;"> <a href="qmbasic_variablenamesandvalues.htm">name format rules</a> </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">A subroutine module is entered by referencing it a </span><span style="font-weight: bold; color: #000000;"><a href="qmb_call.htm">CALL</a></span><span style="color: #000000;"> statement. A subroutine that has no arguments can also be entered by use of the </span><span style="font-weight: bold; color: #000000;"><a href="run.htm">RUN</a></span><span style="color: #000000;"> command or by executing a command name that corresponds to the name of the program in the system catalogue.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">The number of arguments in calls to the subroutine must be the same as in the </span><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;"> statement unless the subroutine is declared with the </span><span style="font-weight: bold; color: #000000;">VAR.ARGS</span><span style="color: #000000;"> option. When </span><span style="font-weight: bold; color: #000000;">VAR.ARGS</span><span style="color: #000000;"> is used, any arguments not passed by the caller will be unassigned. The </span><span style="font-weight: bold; color: #000000;"><a href="qmb_arg_count.htm">ARG.COUNT()</a></span><span style="color: #000000;"> function can be used to determine the actual number of arguments passed. If the values of argument variables are changed by the subroutine, these changes are reflected in the variables used in the </span><span style="font-weight: bold; color: #000000;"><a href="qmb_call.htm">CALL</a></span><span style="color: #000000;"> statement that entered the subroutine.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">Subroutine arguments are normally passed by reference such that changes made to the argument variable inside a subroutine will be visible in the caller's variable referenced by that argument. The </span><span style="font-weight: bold; color: #000000;"><a href="qmb_call.htm">CALL</a></span><span style="color: #000000;"> statement allows arguments to be passed by value by enclosing them in brackets. The </span><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;"> statement also supports this dereferencing syntax. For example</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">SUBROUTINE INVOICE(P, (Q))</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">An argument may refer to a whole matrix. In this case the argument variable name must be preceded by the keyword </span><span style="font-weight: bold; color: #000000;">MAT </span><span style="color: #000000;">and there must be</span><span style="color: #000000;"> a </span><span style="font-weight: bold; color: #000000;"><a href="qmb_dim.htm">DIM</a></span><span style="color: #000000;"> statement following the subroutine declaration to indicate whether this is a one or two dimensional matrix. Alternatively, the dimensions may be given after the variable name in the </span><span style="font-weight: bold; color: #000000;">SUBROUTINE</span><span style="color: #000000;"> statement. In either case, the actual dimension values are counted by the compiler but otherwise ignored. Use of a dimension value of one emphasises to readers of the program that the value is meaningless. A matrix passed as an argument cannot be redimensioned in the subroutine.</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">For example</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">SUBROUTINE MATMAX(MAX, MAT A)</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; DIM A(1)</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; MAX = A(1)</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; N = INMAT(A)</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; FOR I = 2 TO N</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;"> &nbsp;&nbsp;&nbsp;&nbsp; IF A(I) &gt; MAX THEN MAX = A(I)</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;"> &nbsp; NEXT I</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">END</span></p>
<p><span style="color: #000000;"> &nbsp; </span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="color: #000000;">This subroutine scans a one dimensional matrix and passes back the value of the largest element via the MAX argument. The first two lines could alternatively be written as</span></p>
<p><span style="color: #000000;">&nbsp;</span></p>
<p style="margin: 0px 0px 0px 30px;"><span style="font-family: 'Courier New'; color: #000000;">SUBROUTINE MATMAX(MAX, A(1))</span></p>

</td></tr></table>

</body>
</html>
